# Project identification
sonar.projectKey=etiennechabert_terraform-aws-sp-autopilot
sonar.organization=etiennechabert

# Project metadata
sonar.projectName=Terraform AWS Savings Plans Autopilot
sonar.projectVersion=1.0
sonar.links.homepage=https://github.com/etiennechabert/terraform-aws-sp-autopilot
sonar.links.ci=https://github.com/etiennechabert/terraform-aws-sp-autopilot/actions
sonar.links.issue=https://github.com/etiennechabert/terraform-aws-sp-autopilot/issues
sonar.links.scm=https://github.com/etiennechabert/terraform-aws-sp-autopilot

# Source code paths
sonar.sources=.

# Test paths (excluded from analysis)
sonar.tests=lambda/scheduler/tests,lambda/purchaser/tests,lambda/reporter/tests,lambda/shared/tests,lambda/tests
sonar.test.inclusions=**/*test*.py

# Language-specific configurations
# Python
sonar.python.version=3.14

# Coverage Configuration
# Coverage data is collected for visibility but NOT enforced by SonarCloud quality gate
# Coverage enforcement is handled by codecov (see .codecov.yml)
# SonarCloud focuses on: code quality, security vulnerabilities, bugs, code smells
sonar.python.coverage.reportPaths=lambda/scheduler/coverage.xml,lambda/purchaser/coverage.xml,lambda/reporter/coverage.xml

# Terraform (analyzed as IaC)
sonar.iac.terraform.file.patterns=**/*.tf
sonar.terraform.provider.aws.version=5.0

# JavaScript/CSS (embedded in HTML reports - analysis only, no coverage)
sonar.exclusions=\
  **/__pycache__/**,\
  **/*.pyc,\
  **/.pytest_cache/**,\
  **/.coverage,\
  **/htmlcov/**,\
  **/node_modules/**,\
  **/.terraform/**,\
  **/.venv/**,\
  **/venv/**,\
  **/*.egg-info/**,\
  **/local_data/**,\
  **/.git/**,\
  examples/**,\
  terraform-tests/**,\
  docs/**,\
  **/.DS_Store

# Test files exclusion from coverage
sonar.coverage.exclusions=\
  **/tests/**,\
  **/test_*.py,\
  **/*_test.py,\
  lambda/scheduler/tests/**,\
  lambda/purchaser/tests/**,\
  lambda/reporter/tests/**,\
  lambda/shared/tests/**,\
  lambda/tests/**,\
  lambda/local_runner.py

# Duplicate detection
sonar.cpd.exclusions=\
  **/tests/**,\
  **/test_*.py,\
  lambda/reporter/html_report.py,\
  lambda/shared/tests/**,\
  lambda/tests/**

# Issue exclusions (align with existing tools)
# Ruff handles Python linting, tfsec handles Terraform security
# SonarCloud focuses on code quality, bugs, and security
# Coverage enforcement is handled by codecov
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5

# E1: Allow TODO/FIXME comments (managed by team)
sonar.issue.ignore.multicriteria.e1.ruleKey=python:S1135
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.py

# E2: Cognitive complexity in Lambda handlers (AWS patterns)
sonar.issue.ignore.multicriteria.e2.ruleKey=python:S3776
sonar.issue.ignore.multicriteria.e2.resourceKey=**/handler.py

# E3: Too many return statements (AWS Lambda patterns)
sonar.issue.ignore.multicriteria.e3.ruleKey=python:S1142
sonar.issue.ignore.multicriteria.e3.resourceKey=lambda/**/*.py

# E4: Magic numbers in Terraform (configuration values)
sonar.issue.ignore.multicriteria.e4.ruleKey=terraform:S109
sonar.issue.ignore.multicriteria.e4.resourceKey=**/*.tf

# E5: IAM wildcard resources (required for AWS Savings Plans API)
sonar.issue.ignore.multicriteria.e5.ruleKey=terraform:S6302
sonar.issue.ignore.multicriteria.e5.resourceKey=iam.tf

# New Code Definition
sonar.newCodePeriod.type=previous_version

# SCM integration
sonar.scm.provider=git
sonar.scm.disabled=false

# Analysis settings
sonar.sourceEncoding=UTF-8
sonar.verbose=false
